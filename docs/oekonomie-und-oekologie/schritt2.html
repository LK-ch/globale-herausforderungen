<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schritt 2: KlimaverÃ¤nderung</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #2e7d32 0%, #1b5e20 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
        .lesson-header { background: linear-gradient(135deg, #2e7d32 0%, #1b5e20 100%); color: white; padding: 40px; border-radius: 20px 20px 0 0; }
        .lesson-header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .lesson-content { padding: 40px; line-height: 1.8; }
        .lesson-content h2 { color: #2e7d32; margin-top: 30px; margin-bottom: 15px; }
        .lesson-content p { margin-bottom: 15px; }
        .lesson-content ul { margin: 15px 0 15px 30px; }
        .lesson-content li { margin-bottom: 10px; }
        .portfolio-box { background: #e8f5e9; border: 3px solid #2e7d32; border-radius: 15px; padding: 30px; margin: 30px 0; }
        .portfolio-box h3 { color: #1b5e20; margin-bottom: 15px; font-size: 1.5em; }
        .portfolio-box textarea { width: 100%; min-height: 200px; padding: 15px; border: 2px solid #c8e6c9; border-radius: 10px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 1em; resize: vertical; margin-bottom: 15px; }
        .portfolio-box textarea:focus { outline: none; border-color: #2e7d32; box-shadow: 0 0 10px rgba(46, 125, 50, 0.2); }
        .saved-indicator { color: #4CAF50; font-weight: bold; display: none; margin-top: 10px; }
        .button-group { display: flex; gap: 15px; margin-top: 30px; flex-wrap: wrap; }
        button { padding: 15px 30px; border: none; border-radius: 10px; font-size: 1em; font-weight: bold; cursor: pointer; transition: all 0.2s; }
        button:hover { transform: scale(1.05); }
        .btn-back { background: #f5f5f5; color: #333; }
        .btn-complete { background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%); color: white; }
        .info-box { background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; border-radius: 5px; margin: 20px 0; }
        .info-box p { color: #856404; }
    </style>
</head>
<body>
    <div class="container">
        <div class="lesson-header">
            <h1>ğŸ“Š Schritt 2: KlimaverÃ¤nderung (Grafikanalyse)</h1>
            <p>Verstehe die Daten und Fakten zum Klimawandel</p>
        </div>
        <div class="lesson-content">
            <div class="info-box">
                <p><strong>ğŸ’¡ Tipp:</strong> Analysiere Grafiken genau und notiere deine Beobachtungen im Lernjournal.</p>
            </div>
            <h2>ğŸ¯ Lernziele</h2>
            <p>In diesem Schritt wirst du:</p>
            <ul>
                <li>Klimadaten in Grafiken verstehen und interpretieren</li>
                <li>Langfristige Temperaturtrends erkennen</li>
                <li>Den Zusammenhang zwischen COâ‚‚ und Temperatur verstehen</li>
            </ul>
            <h2>ğŸ“ˆ Temperaturanstieg</h2>
            <p>Analysiere die folgende Grafik zur globalen Temperaturentwicklung:</p>
            
            <div class="image-box">
                <img id="climate-image" src="" alt="Klimagrafik" style="display: none; max-width: 100%; height: auto; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                <div id="upload-area" style="border: 3px dashed #2e7d32; padding: 40px; text-align: center; border-radius: 10px; background: #f5f5f5; cursor: pointer;" onclick="document.getElementById('imageUpload').click()">
                    <p style="font-size: 1.2em; color: #2e7d32; margin-bottom: 10px;">ğŸ“Š Klicke hier, um eine Grafik hochzuladen</p>
                    <p style="font-size: 0.9em; color: #666;">Die Grafik wird im PDF-Export des Lernjournals erscheinen</p>
                </div>
                <input type="file" id="imageUpload" accept="image/*" style="display: none;" onchange="handleImageUpload(event)">
                <button id="remove-image-btn" style="display: none; margin-top: 10px; background: #f44336; color: white; padding: 8px 16px; border: none; border-radius: 5px; cursor: pointer;" onclick="removeImage()">ğŸ—‘ï¸ Grafik entfernen</button>
            </div>
            
            <h2>ğŸ“‰ COâ‚‚-Konzentration</h2>
            <p>Die COâ‚‚-Konzentration in der AtmosphÃ¤re hat seit 1750 um Ã¼ber 40% zugenommen.</p>
            <div class="portfolio-box">
                <h3>ğŸ“ Mein Lernjournal: Schritt 2</h3>
                <p style="color: #666; margin-bottom: 15px;">Reflektiere Ã¼ber die Grafiken und Daten:</p>
                <textarea id="portfolio-text" placeholder="â€¢ Welche Trends erkenne ich in den Grafiken?
â€¢ Was Ã¼berrascht mich an den Daten?
â€¢ Wie interpretiere ich die ZusammenhÃ¤nge?" oninput="savePortfolio()"></textarea>
                <div class="saved-indicator" id="saved-indicator">âœ“ Automatisch gespeichert</div>
            </div>
            <div class="button-group">
                <button class="btn-back" onclick="returnToMain()">â† ZurÃ¼ck zur Ãœbersicht</button>
                <button class="btn-complete" onclick="completeStep()">Schritt abschlieÃŸen und weiter â†’</button>
            </div>
        </div>
    </div>
    <script>
        let imageData = null;

        function loadPortfolio() { 
            const saved = localStorage.getItem('learningProgress'); 
            if (saved) { 
                const progress = JSON.parse(saved); 
                const portfolioText = progress.texts && progress.texts['2'] ? progress.texts['2'] : ''; 
                document.getElementById('portfolio-text').value = portfolioText;
                
                // Lade gespeichertes Bild
                if (progress.images && progress.images['2']) {
                    imageData = progress.images['2'];
                    displayImage(imageData);
                }
            } 
        }

        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                imageData = e.target.result;
                displayImage(imageData);
                saveImage();
            };
            reader.readAsDataURL(file);
        }

        function displayImage(data) {
            const img = document.getElementById('climate-image');
            const uploadArea = document.getElementById('upload-area');
            const removeBtn = document.getElementById('remove-image-btn');
            
            img.src = data;
            img.style.display = 'block';
            uploadArea.style.display = 'none';
            removeBtn.style.display = 'inline-block';
        }

        function removeImage() {
            imageData = null;
            const img = document.getElementById('climate-image');
            const uploadArea = document.getElementById('upload-area');
            const removeBtn = document.getElementById('remove-image-btn');
            
            img.src = '';
            img.style.display = 'none';
            uploadArea.style.display = 'block';
            removeBtn.style.display = 'none';
            
            saveImage();
        }

        function saveImage() {
            let progress = JSON.parse(localStorage.getItem('learningProgress') || '{"completedPoints":[],"currentPoint":1,"texts":{},"images":{}}');
            
            if (!progress.images) {
                progress.images = {};
            }
            
            if (imageData) {
                progress.images['2'] = imageData;
            } else {
                delete progress.images['2'];
            }
            
            localStorage.setItem('learningProgress', JSON.stringify(progress));
        }

        function savePortfolio() { 
            const text = document.getElementById('portfolio-text').value; 
            let progress = { completedPoints: [], currentPoint: 1, texts: {}, images: {} }; 
            const saved = localStorage.getItem('learningProgress'); 
            if (saved) { 
                progress = JSON.parse(saved); 
            } 
            if (!progress.texts) { 
                progress.texts = {}; 
            }
            if (!progress.images) {
                progress.images = {};
            }
            progress.texts['2'] = text; 
            localStorage.setItem('learningProgress', JSON.stringify(progress)); 
            const indicator = document.getElementById('saved-indicator'); 
            indicator.style.display = 'block'; 
            setTimeout(() => { 
                indicator.style.display = 'none'; 
            }, 2000); 
        }
        
        function completeStep() { 
            const portfolioText = document.getElementById('portfolio-text').value.trim(); 
            if (portfolioText === '') { 
                const confirm = window.confirm('Du hast noch nichts in dein Lernjournal eingetragen. MÃ¶chtest du trotzdem fortfahren?'); 
                if (!confirm) return; 
            } 
            savePortfolio(); 
            let progress = JSON.parse(localStorage.getItem('learningProgress') || '{"completedPoints":[],"currentPoint":1,"texts":{},"images":{}}'); 
            if (!progress.completedPoints.includes(2)) { 
                progress.completedPoints.push(2); 
                progress.currentPoint = 3; 
                localStorage.setItem('learningProgress', JSON.stringify(progress)); 
            } 
            alert('âœ“ Schritt 2 abgeschlossen!\n\nDein Lernjournal-Eintrag wurde gespeichert.'); 
            window.location.href = 'index.html'; 
        }
        
        function returnToMain() { 
            window.location.href = 'index.html'; 
        }
        
        window.addEventListener('DOMContentLoaded', () => { 
            loadPortfolio(); 
        });
    </script>
</body>
</html>
