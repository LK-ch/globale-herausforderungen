<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schritt 3: Nachhaltige Entwicklung</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #fbbf24 0%, #fb923c 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .lesson-header {
            background: linear-gradient(135deg, #fb923c 0%, #f97316 100%);
            color: white;
            padding: 40px;
            border-radius: 20px 20px 0 0;
        }

        .lesson-header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .lesson-content {
            padding: 40px;
            line-height: 1.8;
        }

        .info-box {
            background: #fef3c7;
            border-left: 4px solid #fb923c;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .info-box p {
            color: #78350f;
        }

        h2 {
            color: #f97316;
            margin: 30px 0 15px 0;
            font-size: 1.6em;
        }

        .btn-back-header {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 20px;
            border: 2px solid white;
            border-radius: 8px;
            font-size: 0.9em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-block;
            text-decoration: none;
            margin-bottom: 20px;
        }

        .btn-back-header:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        /* Reading Text Box */
        .reading-box {
            background: #fff7ed;
            border: 3px solid #fb923c;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            max-height: 500px;
            overflow-y: auto;
        }

        .reading-box h3 {
            color: #f97316;
            margin-bottom: 20px;
        }

        .reading-box p {
            color: #78350f;
            margin-bottom: 15px;
            line-height: 1.8;
        }

        .reading-box strong {
            color: #f97316;
        }

        /* Questions Container */
        .questions-container {
            background: #fff7ed;
            border: 3px solid #fb923c;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .question-block {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .question-number {
            background: linear-gradient(135deg, #fb923c 0%, #f97316 100%);
            color: white;
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .question-text {
            font-size: 1.15em;
            font-weight: bold;
            color: #78350f;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        /* Multiple Choice & Radio */
        .mc-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .mc-option {
            background: #fef3c7;
            border: 2px solid #fde68a;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
        }

        .mc-option:hover:not(.disabled) {
            border-color: #fb923c;
            background: #fde68a;
            transform: translateX(5px);
        }

        .mc-option input[type="radio"] {
            margin-right: 12px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .mc-option.correct {
            background: #d1fae5;
            border-color: #10b981;
        }

        .mc-option.incorrect {
            background: #fee2e2;
            border-color: #ef4444;
        }

        .mc-option.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* Text Input */
        .text-input {
            width: 100%;
            max-width: 400px;
            padding: 12px;
            border: 2px solid #fde68a;
            border-radius: 8px;
            font-size: 1em;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 10px 0;
        }

        .text-input:focus {
            outline: none;
            border-color: #fb923c;
        }

        .text-input.correct {
            border-color: #10b981;
            background: #d1fae5;
        }

        .text-input.incorrect {
            border-color: #ef4444;
            background: #fee2e2;
        }

        /* Check Button */
        .check-btn {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.2s;
        }

        .check-btn:hover:not(:disabled) {
            transform: scale(1.05);
        }

        .check-btn:disabled {
            background: #d1d5db;
            cursor: not-allowed;
        }

        /* Feedback */
        .feedback {
            margin-top: 15px;
            padding: 12px;
            border-radius: 8px;
            display: none;
            font-weight: bold;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: #d1fae5;
            color: #065f46;
            border-left: 4px solid #10b981;
        }

        .feedback.incorrect {
            background: #fee2e2;
            color: #991b1b;
            border-left: 4px solid #ef4444;
        }

        /* SDG Game Styles */
        .game-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .game-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .game-header h3 {
            color: #f97316;
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .sdg-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .sdg-card {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 3px solid #fb923c;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .sdg-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(251, 146, 60, 0.3);
        }

        .sdg-card.selected {
            background: linear-gradient(135deg, #fb923c 0%, #f97316 100%);
            color: white;
            border-color: #ea580c;
        }

        .sdg-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .sdg-title {
            font-size: 0.9em;
            font-weight: bold;
        }

        .scenario-box {
            background: #fef3c7;
            border: 3px solid #fb923c;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
        }

        .scenario-text {
            font-size: 1.1em;
            color: #78350f;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .game-feedback {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            display: none;
        }

        .game-feedback.show {
            display: block;
        }

        .game-feedback.correct {
            background: #d1fae5;
            color: #065f46;
            border-left: 4px solid #10b981;
        }

        .game-feedback.incorrect {
            background: #fee2e2;
            color: #991b1b;
            border-left: 4px solid #ef4444;
        }

        .score-display {
            background: white;
            border: 3px solid #fb923c;
            border-radius: 12px;
            padding: 20px;
            margin: 30px 0;
            text-align: center;
        }

        .score-display h3 {
            color: #f97316;
            margin-bottom: 10px;
        }

        .score-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #fb923c;
        }

        /* Portfolio Box */
        .portfolio-box {
            background: #fef3c7;
            border: 3px solid #fb923c;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .portfolio-box h3 {
            color: #f97316;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .portfolio-box textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #fde68a;
            border-radius: 10px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 1em;
            resize: vertical;
            margin-bottom: 15px;
        }

        .portfolio-box textarea:focus {
            outline: none;
            border-color: #fb923c;
            box-shadow: 0 0 10px rgba(251, 146, 60, 0.2);
        }

        .saved-indicator {
            color: #f97316;
            font-weight: bold;
            display: none;
            margin-top: 10px;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        button {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }

        button:hover {
            transform: scale(1.05);
        }

        .btn-back {
            background: #f5f5f5;
            color: #333;
        }

        .btn-complete {
            background: linear-gradient(135deg, #fb923c 0%, #f97316 100%);
            color: white;
        }

        .btn-pdf {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }

        .btn-save {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 12px 30px;
        }

        .hint-text {
            font-size: 0.9em;
            color: #92400e;
            font-style: italic;
            margin-top: 8px;
        }

        .next-scenario-btn {
            background: linear-gradient(135deg, #fb923c 0%, #f97316 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            display: none;
        }

        .next-scenario-btn.show {
            display: inline-block;
        }

        @media (max-width: 768px) {
            .lesson-header h1 {
                font-size: 1.8em;
            }

            .lesson-content {
                padding: 20px;
            }

            .sdg-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="lesson-header">
            <button class="btn-back-header" onclick="returnToMain()">‚Üê Zur√ºck zur √úbersicht</button>
            <h1>üìö Nachhaltige Entwicklung & Agenda 2030</h1>
        </div>

        <div class="lesson-content">
            <div class="info-box">
                <p><strong>üìã Aufgabe:</strong> Lesen Sie den Text aufmerksam durch und beantworten Sie anschlie√üend die Fragen zum Leseverstehen.</p>
            </div>

            <div class="reading-box">
                <h3>üìñ Lesetext: Die Agenda 2030</h3>
                <p><strong>Wie die Welt nachhaltiger werden soll ‚Äì und was die Schweiz damit zu tun hat</strong></p>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <div style="min-width: 40px; text-align: right; color: #92400e; font-size: 0.9em; line-height: 1.8;">
                        <div>1</div>
                        <div>2</div>
                        <div>3</div>
                        <div>4</div>
                        <div style="margin-top: 15px;">5</div>
                        <div>6</div>
                        <div>7</div>
                        <div>8</div>
                        <div>9</div>
                        <div>10</div>
                        <div>11</div>
                        <div style="margin-top: 15px;">12</div>
                        <div>13</div>
                        <div>14</div>
                        <div>15</div>
                        <div>16</div>
                        <div style="margin-top: 15px;">17</div>
                        <div>18</div>
                        <div>19</div>
                        <div>20</div>
                        <div>21</div>
                        <div>22</div>
                        <div style="margin-top: 15px;">23</div>
                        <div>24</div>
                        <div>25</div>
                        <div>26</div>
                        <div>27</div>
                        <div style="margin-top: 15px;">28</div>
                        <div>29</div>
                        <div>30</div>
                        <div>31</div>
                        <div style="margin-top: 15px;">32</div>
                        <div>33</div>
                        <div>34</div>
                        <div>35</div>
                        <div>36</div>
                        <div>37</div>
                        <div style="margin-top: 15px;">38</div>
                        <div>39</div>
                        <div>40</div>
                        <div style="margin-top: 15px;">41</div>
                        <div>42</div>
                        <div>43</div>
                        <div>44</div>
                        <div>45</div>
                        <div style="margin-top: 15px;">46</div>
                        <div>47</div>
                        <div>48</div>
                    </div>
                    <div style="flex: 1;">
                        <p>Stell dir vor, alle L√§nder der Welt setzen sich gemeinsam an einen Tisch und einigen sich: Bis 2030 wollen wir unseren Planeten zu einem besseren Ort machen. Genau das ist im September 2015 passiert. Die Vereinten Nationen haben die Agenda 2030 verabschiedet ‚Äì einen Plan mit 17 konkreten Zielen, der allen Menschen eine lebenswerte Zukunft erm√∂glichen soll. Klingt ambitioniert? Ist es auch.</p>
                        
                        <p><strong>Nachhaltigkeit ist mehr als Recycling</strong><br>
                        Bevor wir tiefer einsteigen: Was bedeutet Nachhaltigkeit eigentlich? Viele denken da ans Klima oder an M√ºlltrennung. Das stimmt zwar, greift aber zu kurz. Echte Nachhaltigkeit funktioniert nur, wenn drei Bereiche zusammenspielen: Umwelt, Wirtschaft und Soziales. Alle drei m√ºssen gleichzeitig ber√ºcksichtigt werden, sonst ist es keine wirkliche Nachhaltigkeit. Eine L√∂sung, die zwar die Umwelt sch√ºtzt, aber Menschen in die Armut treibt? Nicht nachhaltig. Ein Wirtschaftsmodell, das kurzfristig Gewinn bringt, aber den Planeten zerst√∂rt? Ebenfalls nicht nachhaltig.</p>
                        
                        <p><strong>"Leave no one behind" ‚Äì Niemand wird zur√ºckgelassen</strong><br>
                        Das Besondere an der Agenda 2030: Sie gilt f√ºr alle. Egal ob reiches Industrieland oder √§rmeres Entwicklungsland ‚Äì jedes Land hat Hausaufgaben zu machen. Das war neu. Fr√ºher gab es separate Ziele f√ºr verschiedene L√§ndergruppen, jetzt ziehen alle am selben Strang. Das Motto lautet "Leave no one behind". Besonders die √§rmsten und benachteiligten Menschen sollen von den Ver√§nderungen profitieren.</p>
                        
                        <p><strong>Und was macht die Schweiz?</strong><br>
                        Die Schweiz hat sich wie alle UNO-Mitgliedsstaaten verpflichtet, die Agenda 2030 umzusetzen. Daf√ºr hat der Bundesrat die "Strategie Nachhaltige Entwicklung 2030" entwickelt, die festlegt, wo die Schweiz ihre Schwerpunkte setzt. Alle vier Jahre berichtet die Schweiz der UNO, wie weit sie gekommen ist.</p>
                        
                        <p>In einigen Bereichen l√§uft es gut: Gesundheit, Bildung, Besch√§ftigung und Innovation sind auf gutem Weg. Aber es gibt auch Schwachstellen. Der Ressourcenverbrauch ist zu hoch, beim Klimaschutz muss mehr passieren, und das Konsumverhalten der Schweizer:innen hat negative Auswirkungen auf andere L√§nder ‚Äì zum Beispiel durch Importe, die unter schlechten Bedingungen produziert wurden.</p>
                        
                        <p><strong>Konkrete Beispiele aus der Schweiz</strong><br>
                        Es gibt aber auch positive Entwicklungen: In K√∂niz betreibt ein Restaurant ein ausgekl√ºgeltes System, um Foodwaste zu vermeiden ‚Äì 95 Prozent des verwendeten Gem√ºses ist "Zweitklassware", die sonst weggeworfen w√ºrde. Der Kanton Genf hat als erster Schweizer Kanton "Green Bonds" im Wert von 620 Millionen Franken ausgegeben, um nachhaltige Projekte zu finanzieren. Und in Bern gibt es einen "SDG Walk" ‚Äì einen Rundgang durch die Stadt, der zeigt, wie die 17 Ziele konkret im Alltag aussehen k√∂nnen.</p>
                        
                        <p><strong>Die ern√ºchternde Halbzeitbilanz</strong><br>
                        Wir sind jetzt bei Halbzeit angekommen ‚Äì und ehrlich gesagt: Es sieht nicht gut aus. 2023 zeigte ein UN-Bericht, dass voraussichtlich nur etwa 15 Prozent der gesetzten Ziele erreicht werden. Die Corona-Pandemie hat vieles zur√ºckgeworfen: 93 Millionen Menschen mehr leben jetzt in extremer Armut als vor der Pandemie. Etwa 147 Millionen Kinder haben in den letzten zwei Jahren mehr als die H√§lfte ihres Schulunterrichts verpasst. Frauen leben vielerorts immer noch in schwierigen Verh√§ltnissen.</p>
                        
                        <p>Aber: Die Ziele sind noch erreichbar. Daf√ºr m√ºssen Projekte, finanzielle Hilfen und politische Ma√ünahmen in der verbleibenden Zeit deutlich effizienter und schneller umgesetzt werden.</p>
                        
                        <p><strong>Was hat das mit uns zu tun?</strong><br>
                        Du denkst jetzt vielleicht: "Klingt alles wichtig, aber was kann ich als einzelne Person schon tun?" Tats√§chlich eine Menge. Jede Entscheidung z√§hlt ‚Äì ob du lokale Produkte kaufst, bewusst konsumierst oder dich fragst, ob du wirklich mehr Dinge besitzen musst oder ob das, was du hast, nachhaltiger sein sollte.</p>
                        
                        <p>Aber es geht nicht nur um individuelle Entscheidungen. Auch Unternehmen, die Wirtschaft und der Finanzsektor m√ºssen umdenken. Die gute Nachricht: Immer mehr Firmen begreifen Nachhaltigkeit als Teil ihres Gesch√§ftsmodells. Zudem fordern Kundinnen und Kunden dies zunehmend ein.</p>
                        
                        <p>Auch in der Bildung, Forschung und Innovation liegt gro√ües Potenzial. Die Schweiz kann als reiches und entwickeltes Land mit innovativen Ans√§tzen vorangehen ‚Äì und zeigen, dass nachhaltiges Wirtschaften nicht nur m√∂glich, sondern auch zukunftsf√§hig ist.</p>
                        
                        <p><strong>Realit√§tscheck: Warum ist es so schwierig?</strong><br>
                        Der Optimismus von 2015 ist heute einer gewissen Ern√ºchterung gewichen. Die Welt ist mit vielen Krisen konfrontiert ‚Äì Pandemie, Kriege, Klimakrise. Das macht die Umsetzung der Agenda schwieriger. Aber genau deshalb ist sie so wichtig. Die Alternative w√§re, weiterzumachen wie bisher ‚Äì und das k√∂nnen wir uns schlicht nicht leisten.</p>
                        
                        <p>Die Agenda 2030 ist kein Nice-to-have, sondern eine Notwendigkeit. Sie zeigt, dass wir als globale Gemeinschaft verstanden haben: So geht es nicht weiter. Jetzt m√ºssen wir nur noch entsprechend handeln ‚Äì als Einzelpersonen, als Unternehmen, als Staaten. Die Zeit dr√§ngt, aber die Chance ist noch da.</p>
                    </div>
                </div>
            </div>

            <h2>üìù Aufgabe 1: Leseverstehen</h2>

            <div class="questions-container">
                <!-- Teil A: Detailfragen -->
                <h3 style="color: #f97316; margin-bottom: 20px;">Teil A: Fragen zum Text (5 Fragen)</h3>

                <!-- Frage 1 -->
                <div class="question-block" data-question="1">
                    <span class="question-number">Frage 1</span>
                    <div class="question-text">Wie viele konkrete Ziele umfasst die Agenda 2030?</div>
                    <div class="mc-options">
                        <label class="mc-option">
                            <input type="radio" name="q1" value="12">
                            <span>12 Ziele</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q1" value="17">
                            <span>17 Ziele</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q1" value="20">
                            <span>20 Ziele</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q1" value="25">
                            <span>25 Ziele</span>
                        </label>
                    </div>
                    <button class="check-btn" onclick="checkQuestion(1, 'mc', '17')">√úberpr√ºfen</button>
                    <div class="feedback" id="feedback-1"></div>
                </div>

                <!-- Frage 2 -->
                <div class="question-block" data-question="2">
                    <span class="question-number">Frage 2</span>
                    <div class="question-text">Welche drei Bereiche m√ºssen laut Text zusammenspielen, damit echte Nachhaltigkeit funktioniert?</div>
                    <input type="text" class="text-input" id="q2-input" placeholder="z.B. Bereich 1, Bereich 2, Bereich 3">
                    <p class="hint-text">Geben Sie alle drei Bereiche ein (Reihenfolge egal)</p>
                    <button class="check-btn" onclick="checkQuestion(2, 'text', ['umwelt wirtschaft soziales', 'umwelt soziales wirtschaft', 'wirtschaft umwelt soziales', 'wirtschaft soziales umwelt', 'soziales umwelt wirtschaft', 'soziales wirtschaft umwelt'])">√úberpr√ºfen</button>
                    <div class="feedback" id="feedback-2"></div>
                </div>

                <!-- Frage 3 -->
                <div class="question-block" data-question="3">
                    <span class="question-number">Frage 3</span>
                    <div class="question-text">Was ist laut Text neu an der Agenda 2030 im Vergleich zu fr√ºheren Zielsetzungen?</div>
                    <div class="mc-options">
                        <label class="mc-option">
                            <input type="radio" name="q3" value="nur17">
                            <span>Sie umfasst nur 17 statt mehr Ziele</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q3" value="alle">
                            <span>Sie gilt f√ºr alle L√§nder, nicht nur f√ºr bestimmte L√§ndergruppen</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q3" value="schweiz">
                            <span>Die Schweiz muss zum ersten Mal mitmachen</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q3" value="freiwillig">
                            <span>Die Teilnahme ist freiwillig</span>
                        </label>
                    </div>
                    <button class="check-btn" onclick="checkQuestion(3, 'mc', 'alle')">√úberpr√ºfen</button>
                    <div class="feedback" id="feedback-3"></div>
                </div>

                <!-- Frage 4 -->
                <div class="question-block" data-question="4">
                    <span class="question-number">Frage 4</span>
                    <div class="question-text">Wie viel Prozent der gesetzten Ziele werden laut UN-Bericht von 2023 voraussichtlich erreicht?</div>
                    <input type="text" class="text-input" id="q4-input" placeholder="Zahl eingeben" style="max-width: 100px;">
                    <p class="hint-text">Nur die Zahl eingeben (ohne %)</p>
                    <button class="check-btn" onclick="checkQuestion(4, 'text', ['15', 'f√ºnfzehn'])">√úberpr√ºfen</button>
                    <div class="feedback" id="feedback-4"></div>
                </div>

                <!-- Frage 5: Global -->
                <div class="question-block" data-question="5">
                    <span class="question-number">Frage 5</span>
                    <div class="question-text">Was ist die Hauptaussage des Textes?</div>
                    <div class="mc-options">
                        <label class="mc-option">
                            <input type="radio" name="q5" value="recycling">
                            <span>Recycling ist der wichtigste Schritt zur Nachhaltigkeit</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q5" value="schweiz">
                            <span>Die Schweiz ist Vorreiter bei nachhaltiger Entwicklung</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q5" value="global">
                            <span>Die Agenda 2030 ist ein globaler Plan f√ºr nachhaltige Entwicklung, der dringend umgesetzt werden muss</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q5" value="unm√∂glich">
                            <span>Die Ziele der Agenda 2030 sind nicht mehr erreichbar</span>
                        </label>
                    </div>
                    <button class="check-btn" onclick="checkQuestion(5, 'mc', 'global')">√úberpr√ºfen</button>
                    <div class="feedback" id="feedback-5"></div>
                </div>

                <!-- Teil B: Synonyme -->
                <h3 style="color: #f97316; margin: 40px 0 20px 0;">Teil B: Wortschatz - Finden Sie Synonyme (5 Fragen)</h3>
                <p style="color: #78350f; margin-bottom: 20px;">Welches Wort aus dem Text hat eine √§hnliche Bedeutung?</p>

                <!-- Synonym 1 -->
                <div class="question-block" data-question="6">
                    <span class="question-number">Frage 6</span>
                    <div class="question-text">Synonym f√ºr "vielfach" oder "zahlreich" (siehe Zeile 46):</div>
                    <div class="mc-options">
                        <label class="mc-option">
                            <input type="radio" name="q6" value="ambitioniert">
                            <span>ambitioniert</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q6" value="multiple">
                            <span>multiple</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q6" value="konkret">
                            <span>konkret</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q6" value="ausgekl√ºgelt">
                            <span>ausgekl√ºgelt</span>
                        </label>
                    </div>
                    <button class="check-btn" onclick="checkQuestion(6, 'mc', 'multiple')">√úberpr√ºfen</button>
                    <div class="feedback" id="feedback-6"></div>
                </div>

                <!-- Synonym 2 -->
                <div class="question-block" data-question="7">
                    <span class="question-number">Frage 7</span>
                    <div class="question-text">Synonym f√ºr "schwierig", "unsicher" oder "problematisch" - bezogen auf Lebenssituationen (siehe Zeile 35):</div>
                    <div class="mc-options">
                        <label class="mc-option">
                            <input type="radio" name="q7" value="ambitioniert">
                            <span>ambitioniert</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q7" value="prek√§r">
                            <span>prek√§r</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q7" value="benachteiligt">
                            <span>benachteiligt</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q7" value="separat">
                            <span>separat</span>
                        </label>
                    </div>
                    <button class="check-btn" onclick="checkQuestion(7, 'mc', 'prek√§r')">√úberpr√ºfen</button>
                    <div class="feedback" id="feedback-7"></div>
                </div>

                <!-- Synonym 3 -->
                <div class="question-block" data-question="8">
                    <span class="question-number">Frage 8</span>
                    <div class="question-text">Synonym f√ºr "entt√§uschend" oder "entmutigend" (siehe Zeile 32):</div>
                    <div class="mc-options">
                        <label class="mc-option">
                            <input type="radio" name="q8" value="optimistisch">
                            <span>optimistisch</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q8" value="ern√ºchternd">
                            <span>ern√ºchternd</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q8" value="effizient">
                            <span>effizient</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q8" value="innovativ">
                            <span>innovativ</span>
                        </label>
                    </div>
                    <button class="check-btn" onclick="checkQuestion(8, 'mc', 'ern√ºchternd')">√úberpr√ºfen</button>
                    <div class="feedback" id="feedback-8"></div>
                </div>

                <!-- Synonym 4 -->
                <div class="question-block" data-question="9">
                    <span class="question-number">Frage 9</span>
                    <div class="question-text">Synonym f√ºr "ehrgeizig" oder "anspruchsvoll" (siehe Zeile 4):</div>
                    <div class="mc-options">
                        <label class="mc-option">
                            <input type="radio" name="q9" value="konkret">
                            <span>konkret</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q9" value="separat">
                            <span>separat</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q9" value="ambitioniert">
                            <span>ambitioniert</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q9" value="prek√§r">
                            <span>prek√§r</span>
                        </label>
                    </div>
                    <button class="check-btn" onclick="checkQuestion(9, 'mc', 'ambitioniert')">√úberpr√ºfen</button>
                    <div class="feedback" id="feedback-9"></div>
                </div>

                <!-- Synonym 5 -->
                <div class="question-block" data-question="10">
                    <span class="question-number">Frage 10</span>
                    <div class="question-text">Synonym f√ºr "durchdacht" oder "raffiniert geplant" (siehe Zeile 29):</div>
                    <div class="mc-options">
                        <label class="mc-option">
                            <input type="radio" name="q10" value="ausgekl√ºgelt">
                            <span>ausgekl√ºgelt</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q10" value="benachteiligt">
                            <span>benachteiligt</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q10" value="multiple">
                            <span>multiple</span>
                        </label>
                        <label class="mc-option">
                            <input type="radio" name="q10" value="separat">
                            <span>separat</span>
                        </label>
                    </div>
                    <button class="check-btn" onclick="checkQuestion(10, 'mc', 'ausgekl√ºgelt')">√úberpr√ºfen</button>
                    <div class="feedback" id="feedback-10"></div>
                </div>

                <div class="score-display">
                    <h3>Ihre Punktzahl - Aufgabe 1</h3>
                    <div class="score-number" id="scoreDisplay">0 / 10</div>
                </div>
            </div>

            <h2>üéÆ Aufgabe 2: Interaktives SDG-Spiel</h2>

            <div class="info-box">
                <p><strong>üéØ Spielanleitung:</strong> Ihnen werden verschiedene Alltagssituationen pr√§sentiert. Ordnen Sie jede Situation dem passenden SDG-Ziel (Sustainable Development Goal) zu. Lernen Sie die 17 Ziele und die 5 Ps kennen!</p>
            </div>

            <div class="game-container">
                <div class="game-header">
                    <h3>üåç Die 17 SDG-Ziele kennenlernen</h3>
                    <p style="color: #78350f;">Welches Ziel passt zur Situation?</p>
                </div>

                <div id="scenario-container">
                    <!-- Scenarios will be loaded here -->
                </div>

                <div class="sdg-grid" id="sdg-grid">
                    <!-- SDG cards will be loaded here -->
                </div>

                <div class="game-feedback" id="game-feedback"></div>

                <button class="next-scenario-btn" id="next-scenario-btn" onclick="nextScenario()">
                    N√§chste Situation ‚Üí
                </button>

                <div class="score-display">
                    <h3>Ihre Punktzahl - Aufgabe 2</h3>
                    <div class="score-number" id="gameScore">0 / 8</div>
                    <p style="color: #78350f; margin-top: 10px;">Situation <span id="scenarioProgress">1</span> von 8</p>
                </div>
            </div>

            <div class="portfolio-box">
                <h3>üìù Mein Lernjournal: Schritt 3</h3>
                <p style="color: #78350f; margin-bottom: 15px;">
                    <strong>Reflexionsaufgabe:</strong>
                </p>
                <ul style="margin: 10px 0 15px 20px; line-height: 1.8; color: #78350f;">
                    <li>Welches der 17 SDG-Ziele finden Sie pers√∂nlich am wichtigsten und warum?</li>
                    <li>In welchen Bereichen k√∂nnte die Schweiz noch mehr tun?</li>
                    <li>Was k√∂nnen Sie selbst konkret zur Agenda 2030 beitragen?</li>
                </ul>
                <textarea 
                    id="portfolio-text" 
                    placeholder="Hier Ihre Notizen eintragen..."
                    oninput="savePortfolio()"></textarea>
                <div class="saved-indicator" id="saved-indicator">‚úì Automatisch gespeichert</div>
                
                <button class="btn-save" onclick="savePortfolioManual()">
                    üíæ Speichern
                </button>
            </div>

            <div class="button-group">
                <button class="btn-back" onclick="returnToMain()">
                    ‚Üê Zur√ºck zur √úbersicht
                </button>
                <button class="btn-pdf" onclick="downloadPDF()">
                    üìÑ PDF Schritt 3 herunterladen
                </button>
                <button class="btn-complete" onclick="completeStep()">
                    Schritt abschlie√üen und weiter ‚Üí
                </button>
            </div>
        </div>
    </div>

    <script>
        let score = 0;
        let answeredQuestions = new Set();
        let gameScore = 0;
        let currentScenario = 0;

        // SDG Data
        const sdgs = [
            { num: 1, title: "Keine Armut", category: "People" },
            { num: 2, title: "Kein Hunger", category: "People" },
            { num: 3, title: "Gesundheit", category: "People" },
            { num: 4, title: "Bildung", category: "People" },
            { num: 5, title: "Geschlechter-gleichheit", category: "People" },
            { num: 6, title: "Sauberes Wasser", category: "Planet" },
            { num: 7, title: "Erneuerbare Energie", category: "Planet" },
            { num: 8, title: "Gute Arbeit", category: "Prosperity" },
            { num: 9, title: "Innovation", category: "Prosperity" },
            { num: 10, title: "Weniger Ungleichheit", category: "Peace" },
            { num: 11, title: "Nachhaltige St√§dte", category: "Planet" },
            { num: 12, title: "Verantwortungs-voller Konsum", category: "Planet" },
            { num: 13, title: "Klimaschutz", category: "Planet" },
            { num: 14, title: "Leben im Wasser", category: "Planet" },
            { num: 15, title: "Leben an Land", category: "Planet" },
            { num: 16, title: "Frieden & Gerechtigkeit", category: "Peace" },
            { num: 17, title: "Partnerschaften", category: "Partnership" }
        ];

        // Game Scenarios
        const scenarios = [
            {
                text: "Sarah kauft ihre Kleider nur noch Second Hand oder von fair trade zertifizierten Marken. Sie achtet darauf, dass die Arbeiter:innen fair bezahlt werden.",
                correctSDG: 12,
                explanation: "SDG 12 'Verantwortungsvoller Konsum' passt perfekt! Es geht um nachhaltigen Konsum und faire Produktionsbedingungen.",
                category: "Planet"
            },
            {
                text: "Die Gemeinde installiert Solarpanels auf allen √∂ffentlichen Geb√§uden und f√∂rdert den Umstieg von fossilen Brennstoffen auf erneuerbare Energien.",
                correctSDG: 7,
                explanation: "SDG 7 'Erneuerbare Energie' ist richtig! Dieses Ziel f√∂rdert den Zugang zu bezahlbarer und sauberer Energie.",
                category: "Planet"
            },
            {
                text: "Marc engagiert sich in einem Projekt, das Jugendlichen aus benachteiligten Familien kostenlose Nachhilfe und Unterst√ºtzung bietet.",
                correctSDG: 4,
                explanation: "SDG 4 'Bildung' ist die richtige Antwort! Chancengleiche und hochwertige Bildung f√ºr alle ist das Ziel.",
                category: "People"
            },
            {
                text: "Ein Unternehmen f√ºhrt flexible Arbeitszeiten und gleichen Lohn f√ºr M√§nner und Frauen ein. Zudem werden F√ºhrungspositionen gezielt auch an Frauen vergeben.",
                correctSDG: 5,
                explanation: "SDG 5 'Geschlechtergleichheit' trifft zu! Es geht um gleiche Rechte und Chancen f√ºr alle Geschlechter.",
                category: "People"
            },
            {
                text: "Die Stadt Z√ºrich baut mehr Velowegenetz aus, f√∂rdert den √ñV und schafft autofreie Zonen. Dadurch sinken die CO‚ÇÇ-Emissionen deutlich.",
                correctSDG: 13,
                explanation: "SDG 13 'Klimaschutz' ist korrekt! Ma√ünahmen zur Bek√§mpfung des Klimawandels sind zentral.",
                category: "Planet"
            },
            {
                text: "Eine NGO setzt sich daf√ºr ein, dass Fl√ºchtlinge Zugang zu medizinischer Versorgung, Sprachkursen und Arbeitsm√∂glichkeiten erhalten.",
                correctSDG: 10,
                explanation: "SDG 10 'Weniger Ungleichheit' passt! Es geht um die Verringerung von Ungleichheiten innerhalb und zwischen L√§ndern.",
                category: "Peace"
            },
            {
                text: "Ein Landwirt stellt auf biologische Landwirtschaft um, verzichtet auf Pestizide und sch√ºtzt dadurch Bienen und andere Insekten.",
                correctSDG: 15,
                explanation: "SDG 15 'Leben an Land' ist richtig! Dieses Ziel sch√ºtzt √ñkosysteme, W√§lder und die Artenvielfalt.",
                category: "Planet"
            },
            {
                text: "Die Schweiz und andere L√§nder arbeiten zusammen, um Impfstoffe gerecht weltweit zu verteilen und √§rmere L√§nder finanziell zu unterst√ºtzen.",
                correctSDG: 17,
                explanation: "SDG 17 'Partnerschaften' ist die beste Antwort! Globale Zusammenarbeit ist entscheidend f√ºr die Erreichung aller Ziele.",
                category: "Partnership"
            }
        ];

        function renderSDGGrid() {
            const grid = document.getElementById('sdg-grid');
            grid.innerHTML = '';
            
            sdgs.forEach(sdg => {
                const card = document.createElement('div');
                card.className = 'sdg-card';
                card.dataset.sdg = sdg.num;
                card.innerHTML = `
                    <div class="sdg-number">${sdg.num}</div>
                    <div class="sdg-title">${sdg.title}</div>
                    <div style="font-size: 0.8em; margin-top: 5px; color: #92400e;">${sdg.category}</div>
                `;
                card.onclick = () => selectSDG(sdg.num);
                grid.appendChild(card);
            });
        }

        function renderScenario() {
            if (currentScenario >= scenarios.length) {
                showGameResult();
                return;
            }

            const scenario = scenarios[currentScenario];
            const container = document.getElementById('scenario-container');
            
            container.innerHTML = `
                <div class="scenario-box">
                    <div style="font-weight: bold; color: #f97316; margin-bottom: 10px;">
                        Situation ${currentScenario + 1} von ${scenarios.length}
                    </div>
                    <div class="scenario-text">${scenario.text}</div>
                    <div style="font-weight: bold; color: #78350f; margin-top: 15px;">
                        ‚Üí Welches SDG-Ziel passt am besten zu dieser Situation?
                    </div>
                </div>
            `;

            document.getElementById('scenarioProgress').textContent = currentScenario + 1;
            document.getElementById('game-feedback').classList.remove('show');
            document.getElementById('next-scenario-btn').classList.remove('show');

            // Reset SDG selection
            document.querySelectorAll('.sdg-card').forEach(card => {
                card.classList.remove('selected');
                card.style.pointerEvents = 'auto';
            });
        }

        function selectSDG(selectedNum) {
            const scenario = scenarios[currentScenario];
            const feedback = document.getElementById('game-feedback');
            const isCorrect = selectedNum === scenario.correctSDG;

            // Disable all cards
            document.querySelectorAll('.sdg-card').forEach(card => {
                card.style.pointerEvents = 'none';
            });

            // Highlight selected
            const selectedCard = document.querySelector(`.sdg-card[data-sdg="${selectedNum}"]`);
            selectedCard.classList.add('selected');

            if (isCorrect) {
                gameScore++;
                feedback.className = 'game-feedback correct show';
                feedback.innerHTML = `
                    <strong>‚úì Richtig!</strong> ${scenario.explanation}<br>
                    <span style="font-size: 0.9em; margin-top: 10px; display: inline-block;">
                        üí° Dieses Ziel geh√∂rt zur Kategorie der <strong>"${scenario.category}"</strong> (${getCategoryExplanation(scenario.category)})
                    </span>
                `;
            } else {
                const correctSDG = sdgs.find(s => s.num === scenario.correctSDG);
                feedback.className = 'game-feedback incorrect show';
                feedback.innerHTML = `
                    <strong>‚úó Leider falsch.</strong> Die richtige Antwort w√§re <strong>SDG ${scenario.correctSDG}: ${correctSDG.title}</strong>.<br>
                    ${scenario.explanation}
                `;
            }

            document.getElementById('gameScore').textContent = `${gameScore} / ${scenarios.length}`;
            document.getElementById('next-scenario-btn').classList.add('show');
        }

        function getCategoryExplanation(category) {
            const explanations = {
                "People": "Menschen",
                "Planet": "Planet",
                "Prosperity": "Wohlstand",
                "Peace": "Frieden",
                "Partnership": "Partnerschaft"
            };
            return explanations[category] || category;
        }

        function nextScenario() {
            currentScenario++;
            renderScenario();
        }

        function showGameResult() {
            const container = document.getElementById('scenario-container');
            const percentage = (gameScore / scenarios.length) * 100;
            let emoji, message;

            if (percentage >= 80) {
                emoji = 'üåü';
                message = 'Hervorragend! Sie kennen die SDGs sehr gut!';
            } else if (percentage >= 60) {
                emoji = 'üòä';
                message = 'Gut gemacht! Sie haben ein solides Verst√§ndnis der SDGs.';
            } else {
                emoji = 'üí™';
                message = 'Das war ein guter Anfang! Schauen Sie sich die 17 Ziele nochmal genau an.';
            }

            container.innerHTML = `
                <div class="scenario-box" style="text-align: center; padding: 40px;">
                    <div style="font-size: 5em; margin-bottom: 20px;">${emoji}</div>
                    <h2 style="color: #f97316; margin-bottom: 15px;">Spiel beendet!</h2>
                    <div style="font-size: 2em; font-weight: bold; color: #fb923c; margin: 20px 0;">
                        ${gameScore} / ${scenarios.length}
                    </div>
                    <p style="font-size: 1.2em; color: #78350f;">${message}</p>
                    
                    <div style="margin-top: 30px; text-align: left; background: #fef3c7; padding: 20px; border-radius: 10px;">
                        <h4 style="color: #f97316; margin-bottom: 15px;">üìö Die 5 Ps der Agenda 2030:</h4>
                        <ul style="color: #78350f; line-height: 1.8;">
                            <li><strong>People (Menschen):</strong> SDGs 1-5 ‚Äì Armut, Hunger, Gesundheit, Bildung, Gleichberechtigung</li>
                            <li><strong>Planet:</strong> SDGs 6, 12-15 ‚Äì Wasser, Konsum, Klima, Biodiversit√§t</li>
                            <li><strong>Prosperity (Wohlstand):</strong> SDGs 7-11 ‚Äì Energie, Arbeit, Innovation, Infrastruktur, St√§dte</li>
                            <li><strong>Peace (Frieden):</strong> SDG 16 ‚Äì Rechtsstaatlichkeit, Gerechtigkeit</li>
                            <li><strong>Partnership (Partnerschaft):</strong> SDG 17 ‚Äì Globale Zusammenarbeit</li>
                        </ul>
                    </div>
                </div>
            `;

            document.getElementById('sdg-grid').style.display = 'none';
            document.getElementById('next-scenario-btn').style.display = 'none';
            document.getElementById('game-feedback').classList.remove('show');
        }

        function checkQuestion(questionNum, type, correctAnswer) {
            if (answeredQuestions.has(questionNum)) {
                return;
            }

            const feedback = document.getElementById(`feedback-${questionNum}`);
            const button = document.querySelector(`[data-question="${questionNum}"] .check-btn`);
            let isCorrect = false;

            if (type === 'mc') {
                const selected = document.querySelector(`input[name="q${questionNum}"]:checked`);
                if (!selected) {
                    alert('Bitte w√§hlen Sie eine Antwort aus.');
                    return;
                }
                isCorrect = selected.value === correctAnswer;

                const options = document.querySelectorAll(`input[name="q${questionNum}"]`);
                options.forEach(opt => {
                    opt.disabled = true;
                    opt.parentElement.classList.add('disabled');
                });

                if (isCorrect) {
                    selected.parentElement.classList.add('correct');
                } else {
                    selected.parentElement.classList.add('incorrect');
                    options.forEach(opt => {
                        if (opt.value === correctAnswer) {
                            opt.parentElement.classList.add('correct');
                        }
                    });
                }
            } else if (type === 'text') {
                const input = document.getElementById(`q${questionNum}-input`);
                const userAnswer = input.value.trim().toLowerCase();
                
                if (userAnswer === '') {
                    alert('Bitte geben Sie eine Antwort ein.');
                    return;
                }

                const correctAnswers = Array.isArray(correctAnswer) ? correctAnswer : [correctAnswer];
                isCorrect = correctAnswers.some(ans => 
                    userAnswer === ans.toLowerCase() || 
                    userAnswer.includes(ans.toLowerCase())
                );

                input.disabled = true;
                input.classList.add(isCorrect ? 'correct' : 'incorrect');
            }

            if (isCorrect) {
                score++;
                feedback.className = 'feedback correct show';
                feedback.innerHTML = '<strong>‚úì Richtig!</strong> Sehr gut!';
            } else {
                feedback.className = 'feedback incorrect show';
                
                // Spezifische Feedbacks
                if (questionNum === 2) {
                    feedback.innerHTML = '<strong>‚úó Leider falsch.</strong> Die drei Bereiche sind: <strong>Umwelt, Wirtschaft und Soziales</strong>';
                } else if (questionNum === 4) {
                    feedback.innerHTML = '<strong>‚úó Leider falsch.</strong> Laut UN-Bericht von 2023 werden voraussichtlich nur etwa <strong>15 Prozent</strong> der Ziele erreicht';
                } else {
                    feedback.innerHTML = '<strong>‚úó Leider falsch.</strong> Die richtige Antwort wurde <span style="color: #10b981;">gr√ºn</span> markiert.';
                }
            }

            answeredQuestions.add(questionNum);
            button.disabled = true;
            document.getElementById('scoreDisplay').textContent = `${score} / 10`;
        }

        function loadPortfolio() {
            const saved = localStorage.getItem('learningProgressKonsum');
            if (saved) {
                const progress = JSON.parse(saved);
                const portfolioText = progress.texts && progress.texts['3'] ? progress.texts['3'] : '';
                document.getElementById('portfolio-text').value = portfolioText;
            }
        }

        function savePortfolio() {
            const text = document.getElementById('portfolio-text').value;
            
            let progress = {
                completedPoints: [],
                currentPoint: 1,
                texts: {},
                images: {}
            };
            
            const saved = localStorage.getItem('learningProgressKonsum');
            if (saved) {
                progress = JSON.parse(saved);
            }
            
            if (!progress.texts) {
                progress.texts = {};
            }
            
            progress.texts['3'] = text;
            
            localStorage.setItem('learningProgressKonsum', JSON.stringify(progress));
            
            const indicator = document.getElementById('saved-indicator');
            indicator.style.display = 'block';
            setTimeout(() => {
                indicator.style.display = 'none';
            }, 2000);
        }

        function savePortfolioManual() {
            const text = document.getElementById('portfolio-text').value.trim();
            
            if (text === '') {
                alert('‚ö†Ô∏è Bitte tragen Sie zuerst Ihre Notizen ein.');
                return;
            }
            
            savePortfolio();
            
            const indicator = document.getElementById('saved-indicator');
            indicator.style.display = 'block';
            indicator.textContent = '‚úì Erfolgreich gespeichert!';
            setTimeout(() => {
                indicator.style.display = 'none';
                indicator.textContent = '‚úì Automatisch gespeichert';
            }, 3000);
        }

        function downloadPDF() {
            const portfolioText = document.getElementById('portfolio-text').value.trim();
            
            if (portfolioText === '') {
                alert('Bitte tragen Sie zuerst Ihre Reflexion in das Lernjournal ein.');
                return;
            }
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            doc.setFont("helvetica", "bold");
            doc.setFontSize(20);
            doc.text("Lernjournal: Nachhaltige Entwicklung", 20, 20);
            
            doc.setFont("helvetica", "normal");
            doc.setFontSize(11);
            doc.text(`Datum: ${new Date().toLocaleDateString('de-DE')}`, 20, 30);
            doc.text(`Leseverstehen: ${score}/10 Punkte`, 20, 36);
            doc.text(`SDG-Spiel: ${gameScore}/${scenarios.length} Punkte`, 20, 42);
            
            let yPos = 56;
            
            doc.setFont("helvetica", "bold");
            doc.setFontSize(14);
            doc.text("Meine Reflexion:", 20, yPos);
            yPos += 8;
            
            doc.setFont("helvetica", "normal");
            doc.setFontSize(11);
            const lines = doc.splitTextToSize(portfolioText, 170);
            
            for (let line of lines) {
                if (yPos > 280) {
                    doc.addPage();
                    yPos = 20;
                }
                doc.text(line, 20, yPos);
                yPos += 7;
            }
            
            doc.save('Lernjournal_Schritt3_Nachhaltige_Entwicklung.pdf');
        }

        function completeStep() {
            const portfolioText = document.getElementById('portfolio-text').value.trim();
            
            if (answeredQuestions.size < 10) {
                alert(`‚ö†Ô∏è Hinweis: Sie haben bisher ${answeredQuestions.size} von 10 Leseverst√§ndnisfragen beantwortet.\n\nSie k√∂nnen den Schritt trotzdem abschlie√üen.`);
            }
            
            if (portfolioText === '') {
                const confirm = window.confirm('Sie haben noch nichts in Ihr Lernjournal eingetragen. M√∂chten Sie trotzdem fortfahren?');
                if (!confirm) return;
            }
            
            if (portfolioText !== '') {
                savePortfolio();
            }
            
            let progress = JSON.parse(localStorage.getItem('learningProgressKonsum') || '{"completedPoints":[],"currentPoint":1,"texts":{},"images":{}}');
            
            if (!progress.completedPoints.includes(3)) {
                progress.completedPoints.push(3);
                progress.currentPoint = 4;
                localStorage.setItem('learningProgressKonsum', JSON.stringify(progress));
            }
            
            alert(`‚úì Schritt 3 abgeschlossen!\n\nLeseverstehen: ${score}/10 Punkte\nSDG-Spiel: ${gameScore}/${scenarios.length} Punkte${portfolioText !== '' ? '\nIhr Lernjournal-Eintrag wurde gespeichert.' : ''}`);
            window.location.href = 'index.html';
        }

        function returnToMain() {
            window.location.href = 'index.html';
        }

        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM geladen');
            loadPortfolio();
            console.log('Rendering SDG Grid...');
            renderSDGGrid();
            console.log('Rendering Scenario...');
            renderScenario();
            console.log('Initialisierung abgeschlossen');
        });
    </script>
</body>
</html>
